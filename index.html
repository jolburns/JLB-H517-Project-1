<!DOCTYPE html>
<html>
<head>
	<title>Project 1 - John L Burns - Cholera Map</title>
	<script src="https://d3js.org/d3.v3.min.js"></script>
	<style>
    	text { 
			font-family: Arial; 
			font-size: 15px;
		}
		.axis path, .axis line {
			fill: none;
			stroke: black;
			shape-rendering: crispEdges;
		}
		.tick text {
			fill: black;
			font-size: 11px;
		}

		rect {
			stroke: white;
		}
	</style>
</head>
<body>

	<svg id="map" width="400" height="400">
		<text id='label' x='0' y='20'>1854 Broad Street Cholera Outbreak</text>
		<g transform="translate(30,40)"></g>
	</svg>

	
	<script>
		//setting up variables for later
		var map_width = 600;
		var map_height = 600;
		var max_bar_height = 100;
		var street_start_stop = [];
		var pumps = [];
		
		d3.json('streets.json', function(data) 
		{
			// Loop through all objects
			for (i = 0; i < data.length; i++) 
			{
				street_start_stop.push([i, data[i][0]['x'], data[i][0]['y'], data[i][1]['x'], data[i][1]['y']]);
				if (data[i].length == 3)
				{
					street_start_stop.push([i, data[i][1]['x'], data[i][1]['y'], data[i][2]['x'], data[i][2]['y']]);
				}
			}
			
			
			//select the map svg
			var map_svg = d3.select("#map").attr("width", map_width).attr("height", map_height);
			
			//make the empty lines
			var map_lines = map_svg.selectAll('line').data(street_start_stop).enter().append('line');
			
			//functions to fix scaling
			var x_scale = d3.scale.linear().domain([0, d3.max(street_start_stop, function(sss) {return sss[1];})]).range([-50, map_width-50]);
			var y_scale = d3.scale.linear().domain([0, d3.max(street_start_stop, function(sss) {return sss[2];})]).range([map_height-15, 15]);
			
			//set x1/y1 for the lines
			map_lines.attr('x1', function(sss) {return x_scale(sss[1])}).attr('y1', function(sss) {return y_scale(sss[2])});
			//set x2/y2 for the lines
			map_lines.attr('x2', function(sss) {return x_scale(sss[3])}).attr('y2', function(sss) {return y_scale(sss[4])});
			
			//color in the lines
			map_lines.attr('stroke', "black");
			
		});
		
		/*d3.json('streets.json', function(data) 
		{
			var record = data[0];
				
			// loop through all years, from 1980 to 2012
			for (var y=1980; y<=2012; y++) 
			{
				var value = record[y];
				var object = {
					year: y,
					production: +value
				};

				energyProduction.push(object);
			}
			//drawLineChart();

		});*/

		/*function drawLineChart() 
		{
			var maxValue = 100; 
			
			maxValue = d3.max(energyProduction, function(d) {
				return d.production;
			});
			
			var xScale = d3.scale.linear();
			var yScale = d3.scale.linear();

			xScale.domain([1980, 2012]).range([0, 400]);
			
			yScale.domain([60,maxValue]).range( [CHART_HEIGHT,0]);

			var pathGenerator = d3.svg.line()
				.x(function(d) { return xScale(d.year); })
				.y(function(d) { return yScale(d.production)});

			var g = d3.select('svg').select('g');


			var xAxis = d3.svg.axis()
    			.scale(xScale)
    			.orient('bottom')
    			.tickFormat(function(d) { return "" + d; })

    		var yAxis = d3.svg.axis()
    			.scale(yScale)
    			.orient('left');


    		g.append('g')
    			.attr('class', 'axis')
    			.attr('transform', 'translate(0,' + CHART_HEIGHT + ')')
    			.call(xAxis);

    		g.append('g')
    			.attr('class', 'axis')
    			.call(yAxis);

    		g.append('path')
    			.style('fill', 'none')
    			.style('stroke', 'steelblue')
    			.style('stroke-width', '3px')
    			.attr('d', pathGenerator(energyProduction));


		}*/
			

		
		
	</script>
</body>


</html>
